# Імпортуємо всі необхідні модулі з бібліотеки pygame
from pygame import *
# Імпортуємо функцію randint для генерації випадкових чисел
from random import randint

# Ініціалізуємо всі модулі pygame (запускаємо систему)
init()

# Створюємо вікно розміром 1000x800 пікселів
window = display.set_mode((1000, 800))
# Створюємо об’єкт для контролю частоти кадрів (FPS)
clock = time.Clock()


# =========================
#   КЛАС ГРАВЦЯ (АНІМАЦІЯ)
# =========================
class Player:
   def __init__(self, x, y, width, height, images):
       """
       Ініціалізація гравця:
       x, y — координати верхнього лівого кута;
       width, height — розміри зображення;
       images — список шляхів до файлів із кадрами анімації.
       """

       # Завантажуємо всі зображення, масштабуємо їх до заданого розміру
       self.images = [transform.scale(image.load(img), (width, height)) for img in images]

       # Початковий індекс кадру (який кадр показується зараз)
       self.frame_index = 0

       # Швидкість, з якою змінюються кадри анімації
       self.image_speed = 0.05

       # Отримуємо прямокутник (Rect) першого кадру, щоб визначити позицію
       self.rect = self.images[0].get_rect(topleft=(x, y))

       # Поточне зображення, яке малюється на екрані
       self.current_img = self.images[0]

   def reset(self):
       """Малює поточний кадр гравця на екрані."""
       window.blit(self.current_img, (self.rect.x, self.rect.y))

   def animate(self):
       """Змінює кадри гравця для створення ефекту анімації."""
       # Збільшуємо індекс кадру відповідно до швидкості
       self.frame_index += self.image_speed
       # Якщо індекс виходить за межі списку — починаємо з першого кадру
       if self.frame_index >= len(self.images):
           self.frame_index = 0
       # Оновлюємо поточне зображення для відображення
       self.current_img = self.images[int(self.frame_index)]


# =========================
#     ІНІЦІАЛІЗАЦІЯ ГРИ
# =========================

# Створюємо список назв файлів кадрів (1.png, 2.png)
player_run = [f'{i}.png' for i in range(1, 3)]

# Створюємо об’єкт гравця:
# координати (400, 150), розмір 180x200, зображення зі списку player_run
player = Player(400, 150, 180, 200, player_run)

# Створюємо прямокутник для кнопки "Play"
# Центруємо її по горизонталі та задаємо розмір 350x100
btn_rect = Rect(500 - 350 // 2, 350, 350, 100)

# Створюємо стандартний шрифт (без зовнішнього файлу)
f = font.SysFont(None, 40)

# Генеруємо напис “Play” із вибраним шрифтом, кольором (200,200,220)
play_text = f.render('Play', 1, (200, 200, 220))

# Змінна для паузи між зміною кольорів кнопки
wait = 0


# =========================
#      ОСНОВНИЙ ЦИКЛ ГРИ
# =========================
while True:
   # Обробка подій (натискання клавіш, закриття вікна тощо)
   for e in event.get():
       # Якщо користувач натиснув на “х” — вихід із програми
       if e.type == QUIT:
           quit()

   # Заливаємо фон світло-сірим кольором
   window.fill((220, 230, 230))

   # Оновлюємо кадр анімації гравця
   player.animate()
   # Малюємо поточне зображення гравця на екрані
   player.reset()

   # Керування зміною кольору кнопки
   if wait == 0:
       # Генеруємо випадковий колір RGB
       r = randint(0, 255)
       g = randint(0, 255)
       b = randint(0, 255)
       # Встановлюємо паузу, щоб колір змінювався не щокадрово, а плавніше
       wait = 20
   else:
       # Зменшуємо лічильник очікування
       wait -= 1

   # Малюємо кольорову кнопку (з випадковим кольором) із закругленими краями
   draw.rect(window, (r, g, b), btn_rect, border_radius=15)

   # Малюємо сіру рамку поверх кнопки
   draw.rect(window, (200, 200, 200),
             [btn_rect.x, btn_rect.y, btn_rect.w, btn_rect.h],
             6, border_radius=15)

   # Виводимо текст "Play" поверх кнопки
   window.blit(play_text, (btn_rect.x + 120, btn_rect.y + 20))

   # Оновлюємо все, що намалювали, на екрані
   display.update()

   # Встановлюємо 60 кадрів за секунду
   clock.tick(60)
